var Utilities,ProjectTracking;(function(n){var t=function(){function t(n,t,i){i===void 0&&(i=!1);this.Label=n;this.Value=t;this.selected=i}return t.GetDepartments=function(){n.departments=[];var i=n.GetPath();Utilities.Get(i+"API/Project/Departments/All").then(function(i){var r,u,f;for(console.log("all departments",i),n.departments.push(new t("All Departments","")),n.departments.push(new t("My Departments Only","mine",!0)),r=0,u=i;r<u.length;r++)f=u[r],n.departments.push(f);t.BuildDataValueSelect("departmentFilter",n.departments)},function(n){console.log("error getting permits",n)})},t.GetMyDepartments=function(){n.my_departments=[];var i=n.GetPath();Utilities.Get(i+"API/Project/Departments/My").then(function(i){console.log("my departments",i);n.my_departments=i;t.BuildDataValueSelect("projectDepartment",i)},function(n){console.log("error getting permits",n)})},t.BuildDataValueSelect=function(n,t){var e=document.getElementById(n),r,f,u,i;for(Utilities.Clear_Element(e),r=0,f=t;r<f.length;r++)u=f[r],i=document.createElement("option"),i.value=u.Value,i.selected=u.selected,i.appendChild(document.createTextNode(u.Label)),e.add(i,null)},t.GetFunding=function(){n.funding_sources=[];var i=n.GetPath();Utilities.Get(i+"API/Project/Funding").then(function(i){var r,u,f;for(console.log("all funding",i),r=0,u=i;r<u.length;r++)f=u[r],n.funding_sources.push(f);t.BuildDataValueSelect("projectFunding",n.funding_sources)},function(n){console.log("error getting funding",n)})},t}();n.DataValue=t})(ProjectTracking||(ProjectTracking={})),function(n){function t(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("hide");n.classList.remove("show");n.classList.remove("show-inline");n.classList.remove("show-flex")}function i(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show-flex")}function l(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-inline");n.classList.remove("hide");n.classList.remove("show");n.classList.remove("show-flex")}function a(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-flex");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show")}function e(n,u,f){var e,o,s;typeof n=="string"&&(n=document.getElementById(n));u&&(r(n),e=document.createElement("div"),e.classList.add("notification"),e.classList.add("is-danger"),o=document.createElement("button"),o.classList.add("delete"),o.onclick=function(){t(n)},e.appendChild(o),Array.isArray(u)?(s=document.createElement("ul"),u.forEach(function(n){var t=document.createElement("li");t.appendChild(document.createTextNode(n));s.appendChild(t)}),e.appendChild(s)):e.appendChild(document.createTextNode(u)),n.appendChild(e));i(n);(f==undefined||f===!0)&&window.setTimeout(function(){t(n)},1e4)}function r(n){if(n!==null&&n!==undefined)while(n.firstChild)n.removeChild(n.firstChild)}function v(n,t,i){i===void 0&&(i=!1);var r=document.createElement("option");return r.value=n,r.text=t,r.selected=i,r}function o(n){return typeof n=="string"&&(n=document.getElementById(n)),n.value}function y(n,t){typeof n=="string"&&(n=document.getElementById(n));n.value=t}function u(n,t){typeof n=="string"&&(n=document.getElementById(n));r(n);n.appendChild(document.createTextNode(t))}function s(n){var u=n.replace("nav-",""),r=document.querySelectorAll("#menuTabs > li > a"),t,i;if(r.length>0)for(t=0;t<r.length;t++)i=r.item(t),i.id===n?i.parentElement.classList.add("is-active"):i.parentElement.classList.remove("is-active");f("#views > section",u)}function p(n,t,i){h(n,"nav-"+i);f(t,i)}function h(n,t){var u=document.querySelectorAll(n),i,r;if(u.length>0)for(i=0;i<u.length;i++)r=u.item(i),r.id===t?r.classList.add("is-active"):r.classList.remove("is-active")}function f(n,r){var e=document.querySelectorAll(n),u,f;if(e.length>0)for(u=0;u<e.length;u++)f=e.item(u),f.id===r?i(f):t(f)}function w(n){return fetch(n,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"}).then(function(n){if(console.log("get response",n),!n.ok)throw new Error(n.statusText);return n.json()})}function b(n,t){return fetch(n,{method:"POST",body:JSON.stringify(t),cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(n){if(console.log("Post Response",n),!n.ok)throw new Error(n.statusText);return n.json()})}function k(n,t){return fetch(n,{method:"POST",body:t!==null?JSON.stringify(t):"",cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(n){return n})}function d(n){return n.toLocaleString("en-US",{style:"currency",currency:"USD"})}function g(n){return n instanceof Date?n.toLocaleDateString("en-us"):new Date(n).toLocaleDateString("en-US")}function nt(n,t,i){var r,u;return(typeof n=="string"&&(n=document.getElementById(n)),r=n,r.tagName.toLowerCase()==="select"?r.parentElement.classList.remove("is-danger"):r.classList.remove("is-danger"),u=o(r).trim(),u.length==0)?(r.tagName.toLowerCase()==="select"?r.parentElement.classList.add("is-danger"):r.classList.add("is-danger"),e(t,i),r.focus(),r.scrollTo(),""):u}function tt(n,t){typeof n=="string"&&(n=document.getElementById(n));var i=n;i.disabled=t;i.classList.toggle("is-loading",t)}function it(n){var u=document.createElement("li"),t,i,f,o,r,e,s;if(n.selected&&u.classList.add("is-active"),t=document.createElement("a"),t.id=n.id,t.onclick=function(){c(n)},n.icon.length>0){for(i=document.createElement("span"),i.classList.add("icon"),i.classList.add("is-medium"),f=document.createElement("i"),o=n.icon.split(" "),r=0,e=o;r<e.length;r++)s=e[r],f.classList.add(s);i.appendChild(f);t.appendChild(i)}return t.appendChild(document.createTextNode(n.label)),u.appendChild(t),u}function c(n){u("menuTitle",n.title);u("menuSubTitle",n.subTitle);s(n.id);document.getElementById(n.autofocusId).focus()}function rt(t,i){for(var f,e=document.getElementById(t),r=0,u=i;r<u.length;r++)f=u[r],e.appendChild(n.Create_Menu_Element(f))}function ut(){return(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.DOCUMENT_NODE==!0?"IE":"unknown"}n.Hide=t;n.Show=i;n.Show_Inline=l;n.Show_Flex=a;n.Error_Show=e;n.Clear_Element=r;n.Create_Option=v;n.Get_Value=o;n.Set_Value=y;n.Set_Text=u;n.Show_Menu=s;n.Handle_Tabs=p;n.Activate_Inactivate_Selector=h;n.Show_Hide_Selector=f;n.Get=w;n.Post=b;n.Post_Empty=k;n.Format_Amount=d;n.Format_Date=g;n.Validate_Text=nt;n.Toggle_Loading_Button=tt;n.Create_Menu_Element=it;n.Update_Menu=c;n.Build_Menu_Elements=rt;n.CheckBrowser=ut}(Utilities||(Utilities={})),function(n){"use strict";var t=function(){function t(){this.id=-1;this.project_id=-1;this.comment="";this.update_only=!1;this.added_by="";this.added_on=new Date;this.by_county_manager=!1}return t.UpdateOnly=function(){var t="updateProjectAsUpToDate",i;(Utilities.Toggle_Loading_Button(t,!0),console.log("current project",n.selected_project),n.selected_project.id!==-1)&&(i=n.GetPath(),Utilities.Post_Empty(i+"API/Project/AddUpdateComment?project_id="+n.selected_project.id.toString(),null).then(function(i){console.log("post response",i);i.ok?(n.Project.GetProjects(),n.CloseModals()):(console.log("some errors happened with post response"),alert("There was an issue saving this update.  Please try again, and put in a help desk ticket if the issue persists."));Utilities.Toggle_Loading_Button(t,!1)},function(n){console.log("error getting permits",n);Utilities.Toggle_Loading_Button(t,!1)}))},t.CommentsView=function(t,i){var r,u,o,f,e,s;if(t.sort(function(n,t){return n.id-t.id}),r=document.createDocumentFragment(),t.length===0)return r;for(u=document.createElement("ol"),u.style.marginLeft="1em",o=function(t){var o=document.createElement("li"),l=i?t.added_by+" - "+t.comment:t.comment,s=document.createElement("span"),h,r,c,f,e;s.appendChild(document.createTextNode(l));t.by_county_manager&&(s.style.color="red",s.style.fontWeight="bold");o.appendChild(s);i&&(h=document.createElement("button"),h.classList.add("delete"),o.appendChild(h),r=document.createElement("div"),r.style.display="none",r.classList.add("notification"),r.classList.add("is-danger"),o.appendChild(r),c=document.createElement("span"),c.appendChild(document.createTextNode("Are you sure you want to delete this comment?")),r.appendChild(c),f=document.createElement("button"),f.appendChild(document.createTextNode("Delete")),f.classList.add("button"),f.style.marginRight="1em",f.style.marginLeft="1em",f.onclick=function(){Utilities.Toggle_Loading_Button(f,!0);Utilities.Toggle_Loading_Button(e,!0);var i=n.GetPath();Utilities.Post_Empty(i+"API/Project/DeleteComment?comment_id="+t.id.toString(),null).then(function(n){console.log("post response",n);n.ok||(console.log("some errors happened with post response"),alert("There was an issue deleting this comment.  Please try again, and put in a help desk ticket if the issue persists."));Utilities.Toggle_Loading_Button(f,!1);Utilities.Toggle_Loading_Button(e,!1);r.style.display="none";o.style.display="none"},function(n){console.log("error getting delete comment",n);Utilities.Toggle_Loading_Button(f,!1);Utilities.Toggle_Loading_Button(e,!1)})},r.appendChild(f),e=document.createElement("button"),e.classList.add("button"),e.appendChild(document.createTextNode("Cancel")),e.onclick=function(){r.style.display="none"},r.appendChild(e),h.onclick=function(){r.style.display="block"});u.appendChild(o)},f=0,e=t;f<e.length;f++)s=e[f],o(s);return r.appendChild(u),r},t.PopulateCommentsFieldset=function(n){var r=document.getElementById("existingCommentsContainer"),i=document.createElement("legend");i.classList.add("label");i.appendChild(document.createTextNode("Comments"));r.appendChild(i);r.appendChild(t.CommentsView(n,!0))},t}();n.Comment=t}(ProjectTracking||(ProjectTracking={})),function(n){"use strict";var t=function(){function t(){this.id=-1;this.project_id=-1;this.name="";this.display_order=-1}return t.AddMilestone=function(){var h,k,w,c,o,d,e,l,i,a,v,g,r,y,p,b,f;n.number_of_milestones++;var u=n.number_of_milestones.toString(),tt=t.GetContainer(),nt=document.createDocumentFragment(),s=document.createElement("tr");s.id="milestone"+u;h=document.createElement("td");h.style.textAlign="center";h.style.verticalAlign="middle";h.appendChild(document.createTextNode(u));s.appendChild(h);k=document.createElement("td");w=document.createElement("div");w.classList.add("field");c=document.createElement("div");c.classList.add("control");c.classList.add("is-medium");o=document.createElement("input");o.classList.add("input");o.classList.add("is-medium");o.type="text";o.id="projectMilestone"+u;c.appendChild(o);w.appendChild(c);k.appendChild(w);s.appendChild(k);d=document.createElement("td");e=document.createElement("div");e.classList.add("field");e.classList.add("is-grouped");l=document.createElement("div");l.classList.add("control");i=document.createElement("button");i.id="milestoneUp"+u;i.type="button";i.style.borderRadius="99px";i.setAttribute("aria-label","Move Milestone Up");i.classList.add("button");i.classList.add("is-medium");i.disabled=n.number_of_milestones===1;i.onclick=function(){t.MoveUp(u)};a=document.createElement("span");a.classList.add("icon");a.classList.add("is-large");v=document.createElement("i");v.classList.add("fas");v.classList.add("fa-arrow-circle-up");v.classList.add("fa-2x");a.appendChild(v);i.appendChild(a);l.appendChild(i);g=document.createElement("div");g.classList.add("control");r=document.createElement("button");r.id="milestoneDown"+u;r.type="button";r.style.borderRadius="99px";r.setAttribute("aria-label","Move Milestone Down");r.classList.add("button");r.classList.add("is-medium");r.disabled=!0;r.onclick=function(){t.MoveDown(u)};y=document.createElement("span");y.classList.add("icon");y.classList.add("is-large");p=document.createElement("i");p.classList.add("fas");p.classList.add("fa-arrow-circle-down");p.classList.add("fa-2x");y.appendChild(p);r.appendChild(y);l.appendChild(r);b=document.createElement("div");b.classList.add("control");f=document.createElement("button");f.id="milestoneRemove"+u;f.classList.add("is-warning");f.classList.add("button");f.classList.add("is-medium");f.disabled=n.number_of_milestones===1;f.appendChild(document.createTextNode("Remove"));f.onclick=function(){t.Remove(u)};b.appendChild(f);e.appendChild(l);e.appendChild(g);e.appendChild(b);d.appendChild(e);s.appendChild(d);nt.appendChild(s);tt.appendChild(nt);t.UpdateMilestoneButtons()},t.MoveUp=function(n){var t=parseInt(n);if(t>1){var i="projectMilestone"+n,r="projectMilestone"+(t-1).toString(),u=Utilities.Get_Value(i),f=Utilities.Get_Value(r);Utilities.Set_Value(i,f);Utilities.Set_Value(r,u)}},t.MoveDown=function(t){var i=parseInt(t);if(i<n.number_of_milestones){var r="projectMilestone"+t,u="projectMilestone"+(i+1).toString(),f=Utilities.Get_Value(r),e=Utilities.Get_Value(u);Utilities.Set_Value(r,e);Utilities.Set_Value(u,f)}},t.Remove=function(i){var f=parseInt(i),r,u;if(f<n.number_of_milestones)for(r=f;r<=n.number_of_milestones;r++)t.MoveDown(r.toString());u=document.getElementById("milestone"+n.number_of_milestones.toString());u.parentNode.removeChild(u);n.number_of_milestones--;t.UpdateMilestoneButtons()},t.UpdateMilestoneButtons=function(){for(var i,r,t=1;t<=n.number_of_milestones;t++)i=document.getElementById("milestoneDown"+t.toString()),i.disabled=t===n.number_of_milestones,r=document.getElementById("milestoneRemove"+t.toString()),r.disabled=n.number_of_milestones===1},t.GetContainer=function(){return document.getElementById("projectMilestones")},t.ClearMilestones=function(){n.number_of_milestones=0;Utilities.Clear_Element(t.GetContainer())},t.LoadMilestones=function(n){var i,u,r,e,f;for(t.ClearMilestones(),i=0,u=n;i<u.length;i++)f=u[i],t.AddMilestone();for(r=0,e=n;r<e.length;r++)f=e[r],t.UpdateMilestone(f);t.UpdateMilestoneButtons()},t.UpdateMilestone=function(n){Utilities.Set_Value("projectMilestone"+n.display_order.toString(),n.name)},t.MilestonesView=function(n){var t,i,r,u,e,f;if(n.sort(function(n,t){return n.display_order-t.display_order}),t=document.createDocumentFragment(),n.length===0)return t;for(i=document.createElement("ol"),i.classList.add("comments"),r=0,u=n;r<u.length;r++)e=u[r],f=document.createElement("li"),f.appendChild(document.createTextNode(e.name)),i.appendChild(f);return t.appendChild(i),t},t.ReadMilestones=function(){for(var u,r,f=[],i=50;i>0;i--)u=document.getElementById("projectMilestone"+i.toString()),u!==null&&Utilities.Get_Value(u).trim().length===0&&t.Remove(i.toString());for(i=1;i<=n.number_of_milestones;i++)r=new t,r.display_order=i,r.name=Utilities.Get_Value("projectMilestone"+i.toString()).trim(),f.push(r);return f},t}();n.Milestone=t}(ProjectTracking||(ProjectTracking={})),function(n){"use strict";var t,i;(function(n){n[n.Low=0]="Low";n[n.Normal=1]="Normal";n[n.High=2]="High"})(t=n.PriorityLevel||(n.PriorityLevel={}));i=function(){function i(){this.id=-1;this.project_name="";this.department_id=-1;this.funding_id=1;this.timeline="";this.commissioner_share=!1;this.infrastructure_share=!1;this.legislative_tracking=!1;this.completed=!1;this.date_last_updated=null;this.date_completed=null;this.can_edit=!1;this.milestones=[];this.comments=[]}return i.GetProjects=function(){var t="filterRefreshButton",r;Utilities.Toggle_Loading_Button(t,!0);r=n.GetPath();Utilities.Get(r+"API/Project/List").then(function(r){console.log("projects",r);n.projects=r;i.BuildProjectTrackingList(i.ApplyFilters(r));n.FinishedLoading();r.length===0&&n.AddProjectResultsMessage("No projects were found. You can use the Add Project button to add a new project.");Utilities.Toggle_Loading_Button(t,!1)},function(i){i.message.trim().toLowerCase()==="unauthorized"?n.AddProjectResultsMessage("You do not currently have access to the Project Tracking application."):i&&(n.AddProjectResultsMessage("There was a problem retrieving a list of projects.  Please try again. If this issue persists, please put in a help desk ticket."),console.log("error getting permits",i));Utilities.Toggle_Loading_Button(t,!1)})},i.ApplyFilters=function(i){var u=Utilities.Get_Value("departmentFilter"),f=n.project_name_filter.toUpperCase(),r=document.getElementById("projectCommissionerShareFilter").checked,e=document.getElementById("projectCompleteFilter").checked,o=document.getElementById("projectInfrastructureFilter").checked,s=document.getElementById("projectLegislativeFilter").checked,h=document.getElementById("projectHighPriorityFilter").checked,c=document.getElementById("projectNeedsAttentionFilter").checked;return i=i.filter(function(n){return u.length===0||n.department_id.toString()===u||u==="mine"&&n.can_edit}),i=i.filter(function(n){return r&&n.commissioner_share||!r}),i=i.filter(function(n){return r&&n.commissioner_share||!r}),i=i.filter(function(n){return s&&n.legislative_tracking||!s}),i=i.filter(function(n){return e&&!n.completed||!e}),i=i.filter(function(n){return c&&n.needs_attention||!c}),i=i.filter(function(n){return h&&n.priority===t.High||!h}),i=i.filter(function(n){return o&&n.infrastructure_share||!o}),i.filter(function(n){return f.length>0&&n.project_name.toUpperCase().indexOf(f)>-1||f.length===0})},i.AddProject=function(){Utilities.Hide("updateProjectAsUpToDate");n.selected_project=new i;i.UpdateProjectName("");i.UpdateProjectDepartment("");i.UpdateProjectFunding("0");n.Milestone.ClearMilestones();i.UpdateProjectTimeline("");i.UpdateProjectCompleted(!1);i.UpdateNeedsAttention(!1);i.UpdateProjectPriority(1);i.UpdateCommissionerShare(!1);i.UpdateInfrastructureShare(!1);i.UpdateLegislativeTracking(!1);i.UpdateProjectEstimatedCompletionDate("");var t=document.getElementById("existingCommentsContainer");Utilities.Hide(t);Utilities.Clear_Element(t);i.ClearComment();n.ShowAddProject()},i.LoadProject=function(t){Utilities.Show("updateProjectAsUpToDate");t.comments=t.comments.filter(function(n){return n.comment.length>0});i.UpdateProjectName(t.project_name);i.UpdateProjectDepartment(t.department_id.toString());i.UpdateProjectFunding(t.funding_id.toString());n.Milestone.LoadMilestones(t.milestones);i.UpdateProjectTimeline(t.timeline);i.UpdateProjectCompleted(t.completed);i.UpdateCommissionerShare(t.commissioner_share);i.UpdateInfrastructureShare(t.infrastructure_share);i.UpdateLegislativeTracking(t.legislative_tracking);i.UpdateNeedsAttention(t.needs_attention);i.UpdateProjectEstimatedCompletionDate(Utilities.Format_Date(t.estimated_completion_date));i.UpdateProjectPriority(t.priority);var r=document.getElementById("existingCommentsContainer");Utilities.Clear_Element(r);t.comments.length>0?(Utilities.Show(r),n.Comment.PopulateCommentsFieldset(t.comments)):Utilities.Hide(r);i.ClearComment();n.ShowAddProject()},i.UpdateProjectName=function(n){Utilities.Set_Value("projectName",n)},i.UpdateProjectDepartment=function(n){Utilities.Set_Value("projectDepartment",n)},i.UpdateProjectPriority=function(n){Utilities.Set_Value("projectPriority",n.toString())},i.UpdateProjectEstimatedCompletionDate=function(n){console.log("estimated date",n);document.getElementById("projectEstimatedCompletionDate").valueAsDate=new Date(n)},i.UpdateProjectFunding=function(n){Utilities.Set_Value("projectFunding",n)},i.UpdateProjectTimeline=function(n){Utilities.Set_Value("projectTimeline",n)},i.UpdateProjectCompleted=function(n){var t=document.getElementById("projectComplete");t.checked=n},i.UpdateInfrastructureShare=function(n){var t=document.getElementById("projectInfrastructureShare");t.checked=n},i.UpdateLegislativeTracking=function(n){var t=document.getElementById("projectLegislativeTracking");t.checked=n},i.UpdateCommissionerShare=function(n){var t=document.getElementById("projectCommissionerShare");t.checked=n},i.UpdateNeedsAttention=function(n){var t=document.getElementById("projectNeedsAttention");t.checked=n},i.ClearComment=function(){Utilities.Set_Value("projectComment","")},i.BuildProjectTrackingList=function(n){var f=document.getElementById("projectList"),r,t,u,e;for(Utilities.Clear_Element(f),r=document.createDocumentFragment(),t=0,u=n;t<u.length;t++)e=u[t],r.appendChild(i.CreateProjectRow(e));f.appendChild(r)},i.CreateProjectRow=function(r){var u,h,e,c,p,s,a,v,y,o,k,f;r.comments=r.comments.filter(function(n){return n.comment.length>0});u=document.createElement("tr");r.needs_attention?u.classList.add("needs-attention"):r.completed&&u.classList.add("completed");u.classList.add("pagebreak");h=document.createElement("td");e=document.createElement("div");h.appendChild(e);c=document.createElement("td");p=n.Comment.CommentsView(r.comments,!1);r.can_edit?(s=document.createElement("a"),s.appendChild(document.createTextNode(r.project_name)),s.onclick=function(){n.selected_project=r;i.LoadProject(r);console.log("selected_project",n.selected_project)},e.appendChild(s)):e.appendChild(document.createTextNode(r.project_name));r.priority!==t.Normal&&(f=document.createElement("p"),f.appendChild(document.createTextNode(t[r.priority].toString()+" priority")),e.appendChild(f));r.needs_attention&&(f=document.createElement("p"),f.appendChild(document.createTextNode("Needs Attention")),e.appendChild(f));c.appendChild(p);u.appendChild(h);var w=document.createElement("td"),l=n.departments.filter(function(n){return n.Value===r.department_id.toString()}),d=l.length>0?l[0].Label:"";w.appendChild(document.createTextNode(d));u.appendChild(w);var b=document.createElement("td"),g=n.funding_sources.filter(function(n){return n.Value===r.funding_id.toString()}),nt=l.length>0&&r.funding_id!==-1?g[0].Label:"";return b.appendChild(document.createTextNode(nt)),u.appendChild(b),a=document.createElement("td"),a.appendChild(n.Milestone.MilestonesView(r.milestones)),u.appendChild(a),v=document.createElement("td"),v.appendChild(document.createTextNode(r.timeline)),u.appendChild(v),u.appendChild(c),y=document.createElement("td"),o=document.createElement("div"),o.classList.add("has-text-centered"),y.appendChild(o),o.appendChild(document.createTextNode(Utilities.Format_Date(r.date_last_updated))),new Date(r.estimated_completion_date.toString()).getFullYear()>1e3&&(k=document.createElement("hr"),o.appendChild(k),f=document.createElement("p"),f.appendChild(document.createTextNode(Utilities.Format_Date(r.estimated_completion_date))),o.appendChild(f)),u.appendChild(y),u},i.Save=function(){var i,r,u,f,e,o,s,h,c,l;if(Utilities.Toggle_Loading_Button("saveProject",!0),i=Utilities.Get_Value("projectName").trim(),i.length===0){r=document.getElementById("projectName");u=document.getElementById("projectNameEmpty");Utilities.Error_Show(u,"",!0);r.focus();r.scrollTo();Utilities.Toggle_Loading_Button("saveProject",!1);return}n.selected_project.project_name=i;n.selected_project.milestones=n.Milestone.ReadMilestones();n.selected_project.department_id=parseInt(Utilities.Get_Value("projectDepartment"));n.selected_project.funding_id=parseInt(Utilities.Get_Value("projectFunding"));n.selected_project.timeline=Utilities.Get_Value("projectTimeline");n.selected_project.comment=Utilities.Get_Value("projectComment");n.selected_project.priority=t[Utilities.Get_Value("projectPriority")];n.selected_project.estimated_completion_date=Utilities.Get_Value("projectEstimatedCompletionDate");f=document.getElementById("projectComplete");n.selected_project.completed=f.checked;e=document.getElementById("projectCommissionerShare");n.selected_project.commissioner_share=e.checked;o=document.getElementById("projectInfrastructureShare");n.selected_project.infrastructure_share=o.checked;s=document.getElementById("projectLegislativeTracking");n.selected_project.legislative_tracking=s.checked;h=document.getElementById("projectNeedsAttention");n.selected_project.needs_attention=h.checked;console.log("project to save",n.selected_project);c=n.GetPath();l=n.selected_project.id>-1?"Update":"Add";Utilities.Post_Empty(c+"API/Project/"+l,n.selected_project).then(function(t){console.log("post response",t);t.ok?(console.log("post response good"),n.Project.GetProjects(),n.CloseModals()):console.log("some errors happened with post response");Utilities.Toggle_Loading_Button("saveProject",!1)},function(n){console.log("error getting permits",n);Utilities.Toggle_Loading_Button("saveProject",!1)})},i.PopulatePriorities=function(){var r=document.getElementById("projectPriority"),n,i;Utilities.Clear_Element(r);console.log("prioritylevel",t);for(n in t)n.length<3&&(i=document.createElement("option"),i.value=n.toString(),i.appendChild(document.createTextNode(t[n].toString())),n===t.Normal.toString()&&(i.selected=!0),r.appendChild(i))},i}();n.Project=i}(ProjectTracking||(ProjectTracking={})),function(n){"use strict";function t(){n.DataValue.GetDepartments();n.DataValue.GetFunding();n.DataValue.GetMyDepartments();n.Project.GetProjects();n.Project.PopulatePriorities()}function i(){document.getElementById("addProject").classList.add("is-active")}function r(){var n,t,i;if(Utilities.Toggle_Loading_Button("saveProject",!1),n=document.querySelectorAll(".modal"),n.length>0)for(t=0;t<n.length;t++)i=n.item(t),i.classList.remove("is-active")}function u(){var n="/",t=window.location.pathname.toLowerCase().indexOf("/projecttracking");return t==0&&(n="/projecttracking/"),n}function f(){n.Project.BuildProjectTrackingList(n.Project.ApplyFilters(n.projects))}function e(t){var i=t.value.trim();n.project_name_filter=i.length>2?i:"";n.Project.BuildProjectTrackingList(n.Project.ApplyFilters(n.projects))}function o(){Utilities.Toggle_Loading_Button("addProjectButton",!1);Utilities.Show("filters")}function s(n){var r=document.getElementById("projectList"),i,t;Utilities.Clear_Element(r);i=document.createElement("tr");t=document.createElement("td");t.colSpan=6;t.appendChild(document.createTextNode(n));i.appendChild(t);r.appendChild(i)}n.selected_project=new n.Project;n.projects=[];n.filtered_projects=[];n.departments=[];n.my_departments=[];n.funding_sources=[];n.number_of_milestones=0;n.project_name_filter="";n.Start=t;n.ShowAddProject=i;n.CloseModals=r;n.GetPath=u;n.FilterProjects=f;n.FilterProjectNames=e;n.FinishedLoading=o;n.AddProjectResultsMessage=s}(ProjectTracking||(ProjectTracking={}));